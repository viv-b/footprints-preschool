<div class="wrapper-padding">
    
    <div class="grid-container">
        
        <div class="grid-x grid-margin-x">
            
            <div class="cell">
                <div class="grid-x grid-margin-x small-up-1 medium-up-2 large-up-3">
                    
                    {% comment %}
                    When using 'slugify', if encounters and ampersand, it end up replacing the space before, the ampersand and the space after
                    with just a single hyphen. E.g. Bread & Butter becomes bread-butter.  However, with filenames in CloudCannon,
                    the ampersand is removed but all spaces are replaced with hyphens so the filename becomes bread--butter.
                    Hve used a way to temporarily replace the ampersand with an unlikely string (zzz) and then do the slugifying. See below.
                    {% endcomment %}
                    
                    
                    {% assign replace_ampersand_title = page.title | replace: '&','zzz' %}
                    
                    {% assign slugified_title = replace_ampersand_title | slugify | replace: 'zzz','' %}
                                
                    {% assign sorted_products = site.products | where: "product_type" , slugified_title | sort: "sort_number" | reverse %}
                    
                    {% if sorted_products.size > 0 %}
                                
                        {% for product in sorted_products %}
                                            
                            <div class="cell" style="display: flex;">
                                    
                                <div class="card">
                                    
                                    <span class="editor-only sort-number">Sort: {{ item.sort_number }}</span>
                                    
                                    <a href="{{ site.baseurl }}{{ product.url }}">
                                        {% if product.summary_image != null %}
                                            <img src="//images.weserv.nl/?url={{ site.url | remove: 'https://' | remove: 'http://' }}{{ product.summary_image }}&w=400&h=300&t=square" alt="{{ product.title }}" />
                                        {% else %}
                                            <img src="//images.weserv.nl/?url={{ site.url | remove: 'https://' | remove: 'http://' }}/images/default-no-image.jpg&w=400&h=300&t=square" alt="{{ product.title }}" />
                                        {% endif %}
                                    </a>
                                    <div class="card-section">
                                        <h4><a href="{{ site.baseurl }}{{ product.url }}">{{ product.title }}</h4>
                                        <p>{{ product.content | strip_html | truncatewords: 20,"..." }}</p>
                        	            <p><a class="button" href="{{ site.baseurl }}{{ product.url }}">See Details</a></p>
                                    </div>
                                </div>
                                            
                            </div>
                                      
                        {% endfor %}
                        
                    {% else %}
                        <h3>There are no products in this product category.</h3>
                    {% endif %}
                    
                </div>
            </div>
            
        </div>
    		        
    </div>
</div>